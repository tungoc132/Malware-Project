param ($Remote = ('ori'+'gi'+'n'), [switch]$Force)
Push-Location $PSScriptRoot

$nuspec = [xml](Get-Content poshgit.nuspec)
$version = $nuspec.package.metadata.version
$tag = "v$version"

if ($Force) {
    git tag -f $tag
    git push -f $Remote $tag
}
elseif (!$(git ls-remote $Remote $tag)) {
    Write-Warning ("'$Remote/$tag' "+'not'+' '+'found'+'!'+' '+'U'+'se '+'-Force'+' '+'t'+'o '+'cr'+'eate '+'tag'+' '+'a'+'t '+'HEA'+'D.')
    return
}

choco pack poshgit.nuspec
choco install -f -y poshgit -pre --version=$version -s .

Pop-Location