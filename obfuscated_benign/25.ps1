. $PSScriptRoot\Shared.ps1

Describe ("{0}{1}{2}" -f 'A','NSI ','Tests') {
    Context ("{7}{1}{12}{0}{3}{4}{8}{6}{5}{11}{9}{2}{10}"-f' correc','etur','o','t ANSI',' s','ie',' for specif','R','equence','c','lors','d ','ns') {
        It ("{12}{10}{8}{2}{13}{7}{4}{0}{1}{11}{6}{3}{5}{9}"-f'o 0x0 resu','lts ','i','lack ba','t','ckgro','B','ackgroundColor ','tt','und','e','in ','S','ng B') {
            $ts = & $module.NewBoundScriptBlock({[PoshGitTextSpan]::new(("{1}{0}"-f'ST','TE'), 0xFF0000, 0)})
            $ansiStr = $ts.toAnsiString()
            $ansiStr | Should BeExactly "${csi}38;2;255;0;0m${csi}48;2;0;0;0mTEST${csi}39;49m"
        }
        It ("{9}{5}{1}{6}{0}{2}{7}{3}{4}{8}{10}" -f'Co','g Fo','lor to 0x0 res','s in',' Black','ttin','reground','ult',' foregr','Se','ound') {
            $ts = & $module.NewBoundScriptBlock({[PoshGitTextSpan]::new(("{0}{1}" -f 'T','EST'), 0, 0xFFFFFF)})
            $ansiStr = $ts.toAnsiString()
            $ansiStr | Should BeExactly "${csi}38;2;0;0;0m${csi}48;2;255;255;255mTEST${csi}39;49m"
        }
    }
}