

Process Argument Tree of ObfuscatedCommand with current launcher:
powerSHeLL   "




function Get-AuthToken {



[cmdletbinding()]

param
(
    [Parameter(Mandatory=$true)]
    $User

)

$userUpn = New-Object \"System.Net.Mail.MailAddress\" -ArgumentList $User

$tenant = $userUpn.Host

Write-Host \"Checking for AzureAD module...\"

    $AadModule = Get-Module -Name \"AzureAD\" -ListAvailable

    if ($AadModule -eq $null) {

        Write-Host \"AzureAD PowerShell module not found, looking for AzureADPreview\"
        $AadModule = Get-Module -Name \"AzureADPreview\" -ListAvailable

    }

    if ($AadModule -eq $null) {
        write-host
        write-host \"AzureAD Powershell module not installed...\" -f Red
        write-host \"Install by running 'Install-Module AzureAD' or 'Install-Module AzureADPreview' from an elevated PowerShell prompt\" -f Yellow
        write-host \"Script can't continue...\" -f Red
        write-host
        exit
    }




    if($AadModule.count -gt 1){

        $Latest_Version = ($AadModule | select version | Sort-Object)[-1]

        $aadModule = $AadModule | ? { $_.version -eq $Latest_Version.version }

        $adal = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.dll\"
        $adalforms = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll\"

    }

    else {

        $adal = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.dll\"
        $adalforms = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll\"

    }

[System.Reflection.Assembly]::LoadFrom($adal) | Out-Null

[System.Reflection.Assembly]::<REDACTED: ArgumentLength = 87300>BPUkFUSU9OLCBMPVJFRE1PTkQsIFM9V0FTSElOR1RPTiwgQz1VUyIgUHJvZHVjdE5hbWU9Ik1JQ1JPU09GVCBPRkZJQ0UgSEVMUCBWSUVXRVIiIEJpbmFyeU5hbWU9IioiPg0KICAgICAgICAgIDxCaW5hcnlWZXJzaW9uUmFuZ2UgTG93U2VjdGlvbj0iKiIgSGlnaFNlY3Rpb249IioiIC8+DQogICAgICAgIDwvRmlsZVB1Ymxpc2hlckNvbmRpdGlvbj4NCiAgICAgIDwvQ29uZGl0aW9ucz4NCiAgICA8L0ZpbGVQdWJsaXNoZXJSdWxlPg0KCTwvUnVsZUNvbGxlY3Rpb24+DQo8L0FwcExvY2tlclBvbGljeT4=",
      "id": "4e49ffae-f006-46b9-b74d-785565f7efb4",
      "@odata.type": "
    }
  ],
  "exemptAppLockerFiles": [],
  "enterpriseNetworkDomainNames": [],
  "enterpriseProxiedDomains": [
    {
      "displayName": "SharePoint",
      "proxiedDomains": [
        {
          "ipAddressOrFQDN": "$Sharepoint.sharepoint.com",
          "@odata.type": "
        },
        {
          "ipAddressOrFQDN": "$Sharepoint-my.sharepoint.com",
          "@odata.type": "
        },
        {
          "ipAddressOrFQDN": "$Sharepoint.sharepoint.com",
          "@odata.type": "
        }
      ],
      "@odata.type": "
    }
  ],
  "enterpriseIPRanges": [],
  "enterpriseIPRangesAreAuthoritative": false,
  "enterpriseProxyServers": [],
  "enterpriseInternalProxyServers": [],
  "enterpriseProxyServersAreAuthoritative": false,
  "neutralDomainResources": [],
  "@odata.type": "
}

"\"



Write-Host \"Adding Windows Information Protection Without Enrollment Policy from JSON...\" -ForegroundColor Yellow

Add-WindowsInformationProtectionPolicy -JSON $ManagedAppPolicy_WIP

Write-Host

Write-Host \"Adding Windows Information Protection MDM Policy from JSON...\" -ForegroundColor Yellow

Add-MDMWindowsInformationProtectionPolicy -JSON $ManagedAppPolicy_WIP_MDM

Write-Host"

WARNING: This command exceeds the cmd.exe maximum allowed length of 8190 characters! Its length is 87300 characters.

Executed:
  CLI:  Launcher\PS\0
  FULL: Out-PowerShellLauncher -ScriptBlock $ScriptBlock 1

Result:
powerSHeLL   "




function Get-AuthToken {



[cmdletbinding()]

param
(
    [Parameter(Mandatory=$true)]
    $User

)

$userUpn = New-Object \"System.Net.Mail.MailAddress\" -ArgumentList $User

$tenant = $userUpn.Host

Write-Host \"Checking for AzureAD module...\"

    $AadModule = Get-Module -Name \"AzureAD\" -ListAvailable

    if ($AadModule -eq $null) {

        Write-Host \"AzureAD PowerShell module not found, looking for AzureADPreview\"
        $AadModule = Get-Module -Name \"AzureADPreview\" -ListAvailable

    }

    if ($AadModule -eq $null) {
        write-host
        write-host \"AzureAD Powershell module not installed...\" -f Red
        write-host \"Install by running 'Install-Module AzureAD' or 'Install-Module AzureADPreview' from an elevated PowerShell prompt\" -f Yellow
        write-host \"Script can't continue...\" -f Red
        write-host
        exit
    }




    if($AadModule.count -gt 1){

        $Latest_Version = ($AadModule | select version | Sort-Object)[-1]

        $aadModule = $AadModule | ? { $_.version -eq $Latest_Version.version }

        $adal = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.dll\"
        $adalforms = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll\"

    }

    else {

        $adal = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.dll\"
        $adalforms = Join-Path $AadModule.ModuleBase \"Microsoft.IdentityModel.Clients.ActiveDirectory.Platform.dll\"

    }

[System.Reflection.Assembly]::LoadFrom($adal) | Out-Null

[Syste<REDACTED: ObfuscatedLength = 87300>PVJFRE1PTkQsIFM9V0FTSElOR1RPTiwgQz1VUyIgUHJvZHVjdE5hbWU9Ik1JQ1JPU09GVCBPRkZJQ0UgSEVMUCBWSUVXRVIiIEJpbmFyeU5hbWU9IioiPg0KICAgICAgICAgIDxCaW5hcnlWZXJzaW9uUmFuZ2UgTG93U2VjdGlvbj0iKiIgSGlnaFNlY3Rpb249IioiIC8+DQogICAgICAgIDwvRmlsZVB1Ymxpc2hlckNvbmRpdGlvbj4NCiAgICAgIDwvQ29uZGl0aW9ucz4NCiAgICA8L0ZpbGVQdWJsaXNoZXJSdWxlPg0KCTwvUnVsZUNvbGxlY3Rpb24+DQo8L0FwcExvY2tlclBvbGljeT4=",
      "id": "4e49ffae-f006-46b9-b74d-785565f7efb4",
      "@odata.type": "
    }
  ],
  "exemptAppLockerFiles": [],
  "enterpriseNetworkDomainNames": [],
  "enterpriseProxiedDomains": [
    {
      "displayName": "SharePoint",
      "proxiedDomains": [
        {
          "ipAddressOrFQDN": "$Sharepoint.sharepoint.com",
          "@odata.type": "
        },
        {
          "ipAddressOrFQDN": "$Sharepoint-my.sharepoint.com",
          "@odata.type": "
        },
        {
          "ipAddressOrFQDN": "$Sharepoint.sharepoint.com",
          "@odata.type": "
        }
      ],
      "@odata.type": "
    }
  ],
  "enterpriseIPRanges": [],
  "enterpriseIPRangesAreAuthoritative": false,
  "enterpriseProxyServers": [],
  "enterpriseInternalProxyServers": [],
  "enterpriseProxyServersAreAuthoritative": false,
  "neutralDomainResources": [],
  "@odata.type": "
}

"\"



Write-Host \"Adding Windows Information Protection Without Enrollment Policy from JSON...\" -ForegroundColor Yellow

Add-WindowsInformationProtectionPolicy -JSON $ManagedAppPolicy_WIP

Write-Host

Write-Host \"Adding Windows Information Protection MDM Policy from JSON...\" -ForegroundColor Yellow

Add-MDMWindowsInformationProtectionPolicy -JSON $ManagedAppPolicy_WIP_MDM

Write-Host"

# WARNING: This command exceeds the cmd.exe maximum length of 8190.Its length is 87300 characters.